
##Set working directory
#setwd("C:/Users/LaSalle/Desktop/José Luis/El Quantificador/Datos")
setwd("C:/Users/jose.sola/Desktop/José Luis RA/Info")

##Data scrapping
#Downloading link
url2019<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2019.zip"
url2018<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2018.zip"
url2017<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2017.zip"
url2016<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2016.zip"
url2015<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2015.zip"
url2014<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2014.zip"
url2013<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2013.zip"
url2012<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2012.zip"
url2011<-"https://mercadodevalores.supercias.gob.ec/reportes/zip/estadosFinancieros_2011.zip"

#To store zip temporarily
#temp<-tempfile()
#download.file(url2019,temp)
#data<-read.delim(unz(temp,"bal2019.txt"))

#To store zip in folder
#download.file(url2019,"estadosFinancieros_2019.zip")
download.file(url2018,"estadosFinancieros_2018.zip")
download.file(url2017,"estadosFinancieros_2017.zip")
download.file(url2016,"estadosFinancieros_2016.zip")
download.file(url2015,"estadosFinancieros_2015.zip")
download.file(url2014,"estadosFinancieros_2014.zip")
download.file(url2013,"estadosFinancieros_2013.zip")
download.file(url2012,"estadosFinancieros_2012.zip")
download.file(url2011,"estadosFinancieros_2011.zip")
#options(timeout=300)
#Decompress zip
#unzip("estadosFinancieros_2019.zip")
unzip("estadosFinancieros_2018.zip")
unzip("estadosFinancieros_2017.zip")
unzip("estadosFinancieros_2016.zip")
unzip("estadosFinancieros_2015.zip")
unzip("estadosFinancieros_2014.zip")
unzip("estadosFinancieros_2013.zip")
unzip("estadosFinancieros_2012.zip")
unzip("estadosFinancieros_2011.zip")

library(tidyverse) 
library(outliers)
#Reading in a zip data file (unzipping it)

data2019a<-read.delim("balances_2019_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2019a<- data2019a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2019b<-read.delim("balances_2019_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2019b<- data2019b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2019c<-read.delim("balances_2019_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2019c<- data2019c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2019d<-read.delim("balances_2019_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2019d<- data2019d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2019e<-read.delim("balances_2019_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2019e<- data2019e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2019 <- merge(data2019a, data2019b , all = T)
data2019 <- merge(data2019c, data2019 , all = T)
data2019 <- merge(data2019d, data2019 , all = T)
data2019 <- merge(data2019e, data2019 , all = T)
remove(data2019a)
remove(data2019b)
remove(data2019c)
remove(data2019d)
remove(data2019e)

data2018a<-read.delim("balances_2018_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2018a<- data2018a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2018b<-read.delim("balances_2018_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2018b<- data2018b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2018c<-read.delim("balances_2018_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2018c<- data2018c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2018d<-read.delim("balances_2018_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2018d<- data2018d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2018e<-read.delim("balances_2018_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2018e<- data2018e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2018 <- merge(data2018a, data2018b , all = T)
data2018 <- merge(data2018c, data2018 , all = T)
data2018 <- merge(data2018d, data2018 , all = T)
data2018 <- merge(data2018e, data2018 , all = T)
remove(data2018a)
remove(data2018b)
remove(data2018c)
remove(data2018d)
remove(data2018e)

data2017a<-read.delim("balances_2017_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2017a<- data2017a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2017b<-read.delim("balances_2017_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",,quote="")
data2017b<- data2017b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2017c<-read.delim("balances_2017_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2017c<- data2017c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2017d<-read.delim("balances_2017_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2017d<- data2017d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2017e<-read.delim("balances_2017_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2017e<- data2017e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2017f<-read.delim("balances_2017_6.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2017f<- data2017f%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2017 <- merge(data2017a, data2017b , all = T)
data2017 <- merge(data2017c, data2017 , all = T)
data2017 <- merge(data2017d, data2017 , all = T)
data2017 <- merge(data2017e, data2017 , all = T)
data2017 <- merge(data2017f, data2017 , all = T)
remove(data2017a)
remove(data2017b)
remove(data2017c)
remove(data2017d)
remove(data2017e)
remove(data2017f)

data2016a<-read.delim("balances_2016_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016a<- data2016a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2016b<-read.delim("balances_2016_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016b<- data2016b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_360, CUENTA_361, CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_335, CUENTA_336, CUENTA_337, CUENTA_338, CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2016c<-read.delim("balances_2016_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016c<- data2016c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2016d<-read.delim("balances_2016_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2016d<- data2016d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2016e<-read.delim("balances_2016_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016e<- data2016e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2016f<-read.delim("balances_2016_6.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016f<- data2016f%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2016g<-read.delim("balances_2016_7.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2016g<- data2016g%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2016 <- merge(data2016a, data2016b , all = T)
data2016 <- merge(data2016c, data2016 , all = T)
data2016 <- merge(data2016d, data2016 , all = T)
data2016 <- merge(data2016e, data2016 , all = T)
data2016 <- merge(data2016f, data2016 , all = T)
data2016 <- merge(data2016g, data2016 , all = T)
remove(data2016a)
remove(data2016b)
remove(data2016c)
remove(data2016d)
remove(data2016e)
remove(data2016f)
remove(data2016g)

data2015a<-read.delim("balances_2015_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015a<- data2015a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2015b<-read.delim("balances_2015_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015b<- data2015b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_350, CUENTA_351, CUENTA_352, CUENTA_353, CUENTA_354, CUENTA_355, CUENTA_356, CUENTA_357, CUENTA_358, CUENTA_359, CUENTA_360, CUENTA_361,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_515, CUENTA_516, CUENTA_532, CUENTA_533,CUENTA_541, CUENTA_542, CUENTA_543, CUENTA_544,CUENTA_545, CUENTA_546, CUENTA_555, CUENTA_556,CUENTA_6011, CUENTA_6021, CUENTA_6031, CUENTA_6041, CUENTA_6051, CUENTA_6061, CUENTA_6071, CUENTA_6081, CUENTA_6091, CUENTA_6101, CUENTA_6111,CUENTA_6011, CUENTA_6021, CUENTA_6031, CUENTA_6041,CUENTA_6061, CUENTA_6121, CUENTA_6131,CUENTA_7010, CUENTA_7011, CUENTA_7021, CUENTA_7031, CUENTA_7041, CUENTA_7051, CUENTA_7061, CUENTA_7071, CUENTA_7081, CUENTA_7091, CUENTA_7101, CUENTA_7111, CUENTA_7121, CUENTA_7131, CUENTA_7141, CUENTA_7151, CUENTA_7161, CUENTA_7171, CUENTA_7181, CUENTA_7191, CUENTA_7201, CUENTA_7211, CUENTA_7221, CUENTA_7231, CUENTA_7241, CUENTA_7251, CUENTA_7262, CUENTA_7271, CUENTA_7281, CUENTA_7291, CUENTA_7301, CUENTA_7311, CUENTA_7321, CUENTA_7331, CUENTA_7341, CUENTA_7351, CUENTA_7361, CUENTA_7371, CUENTA_7381, CUENTA_7391, CUENTA_7401,CUENTA_7411, CUENTA_7421, CUENTA_7431, CUENTA_7441, CUENTA_7451, CUENTA_7481, CUENTA_7491, CUENTA_7501, CUENTA_7511, CUENTA_7521, CUENTA_7531, CUENTA_7551, CUENTA_7561, CUENTA_7571, CUENTA_7581, CUENTA_7591,CUENTA_7032, CUENTA_7132, CUENTA_7142, CUENTA_7152, CUENTA_7162, CUENTA_7172, CUENTA_7242, CUENTA_7252, CUENTA_7262, CUENTA_7272, CUENTA_7282, CUENTA_7292, CUENTA_7402, CUENTA_7412, CUENTA_7502, CUENTA_7512, CUENTA_7522, CUENTA_7542, CUENTA_7562,CUENTA_7182, CUENTA_7192, CUENTA_7202, CUENTA_7212, CUENTA_7222, CUENTA_7232, CUENTA_7422, CUENTA_7432, CUENTA_7442, CUENTA_7452, CUENTA_7462, CUENTA_7472, CUENTA_7482, CUENTA_7492, CUENTA_7572, CUENTA_7582, CUENTA_7592,CUENTA_7302, CUENTA_7312, CUENTA_7322, CUENTA_7332, CUENTA_7342, CUENTA_7352, CUENTA_7362, CUENTA_7372, CUENTA_7382, CUENTA_7392,CUENTA_499,CUENTA_326, CUENTA_327, CUENTA_328, CUENTA_329, CUENTA_330, CUENTA_331, CUENTA_332, CUENTA_333, CUENTA_334, CUENTA_335, CUENTA_336,CUENTA_7132,CUENTA_7152)
data2015c<-read.delim("balances_2015_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2015c<- data2015c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_360, CUENTA_361, CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_335, CUENTA_336, CUENTA_337, CUENTA_338, CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2015d<-read.delim("balances_2015_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015d<- data2015d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2015e<-read.delim("balances_2015_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015e<- data2015e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2015f<-read.delim("balances_2015_6.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015f<- data2015f%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2015g<-read.delim("balances_2015_7.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015g<- data2015g%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2015h<-read.delim("balances_2015_8.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2015h<- data2015h%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2015 <- merge(data2015a, data2015b , all = T)
data2015 <- merge(data2015c, data2015 , all = T)
data2015 <- merge(data2015d, data2015 , all = T)
data2015 <- merge(data2015e, data2015 , all = T)
data2015 <- merge(data2015f, data2015 , all = T)
data2015 <- merge(data2015g, data2015 , all = T)
data2015 <- merge(data2015h, data2015 , all = T)
remove(data2015a)
remove(data2015b)
remove(data2015c)
remove(data2015d)
remove(data2015e)
remove(data2015f)
remove(data2015g)
remove(data2015h)

data2014a<-read.delim("balances_2014_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014a<- data2014a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2014b<-read.delim("balances_2014_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2014b <- data2014b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_350, CUENTA_351, CUENTA_352, CUENTA_353, CUENTA_354, CUENTA_355, CUENTA_356, CUENTA_357, CUENTA_358, CUENTA_359, CUENTA_360, CUENTA_361,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_515, CUENTA_516, CUENTA_532, CUENTA_533,CUENTA_541, CUENTA_542, CUENTA_543, CUENTA_544,CUENTA_545, CUENTA_546, CUENTA_555, CUENTA_556,CUENTA_6011, CUENTA_6021, CUENTA_6031, CUENTA_6041, CUENTA_6051, CUENTA_6061, CUENTA_6071, CUENTA_6081, CUENTA_6091, CUENTA_6101, CUENTA_6111,CUENTA_6011, CUENTA_6021, CUENTA_6031, CUENTA_6041,CUENTA_6061, CUENTA_6121, CUENTA_6131,CUENTA_7010, CUENTA_7011, CUENTA_7021, CUENTA_7031, CUENTA_7041, CUENTA_7051, CUENTA_7061, CUENTA_7071, CUENTA_7081, CUENTA_7091, CUENTA_7101, CUENTA_7111, CUENTA_7121, CUENTA_7131, CUENTA_7141, CUENTA_7151, CUENTA_7161, CUENTA_7171, CUENTA_7181, CUENTA_7191, CUENTA_7201, CUENTA_7211, CUENTA_7221, CUENTA_7231, CUENTA_7241, CUENTA_7251, CUENTA_7262, CUENTA_7271, CUENTA_7281, CUENTA_7291, CUENTA_7301, CUENTA_7311, CUENTA_7321, CUENTA_7331, CUENTA_7341, CUENTA_7351, CUENTA_7361, CUENTA_7371, CUENTA_7381, CUENTA_7391, CUENTA_7401,CUENTA_7411, CUENTA_7421, CUENTA_7431, CUENTA_7441, CUENTA_7451, CUENTA_7481, CUENTA_7491, CUENTA_7501, CUENTA_7511, CUENTA_7521, CUENTA_7531, CUENTA_7551, CUENTA_7561, CUENTA_7571, CUENTA_7581, CUENTA_7591,CUENTA_7032, CUENTA_7132, CUENTA_7142, CUENTA_7152, CUENTA_7162, CUENTA_7172, CUENTA_7242, CUENTA_7252, CUENTA_7262, CUENTA_7272, CUENTA_7282, CUENTA_7292, CUENTA_7402, CUENTA_7412, CUENTA_7502, CUENTA_7512, CUENTA_7522, CUENTA_7542, CUENTA_7562,CUENTA_7182, CUENTA_7192, CUENTA_7202, CUENTA_7212, CUENTA_7222, CUENTA_7232, CUENTA_7422, CUENTA_7432, CUENTA_7442, CUENTA_7452, CUENTA_7462, CUENTA_7472, CUENTA_7482, CUENTA_7492, CUENTA_7572, CUENTA_7582, CUENTA_7592,CUENTA_7302, CUENTA_7312, CUENTA_7322, CUENTA_7332, CUENTA_7342, CUENTA_7352, CUENTA_7362, CUENTA_7372, CUENTA_7382, CUENTA_7392,CUENTA_499,CUENTA_326, CUENTA_327, CUENTA_328, CUENTA_329, CUENTA_330, CUENTA_331, CUENTA_332, CUENTA_333, CUENTA_334, CUENTA_335, CUENTA_336,CUENTA_7132,CUENTA_7152)
data2014c<-read.delim("balances_2014_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014c <- data2014c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_360, CUENTA_361, CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_335, CUENTA_336, CUENTA_337, CUENTA_338, CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2014d<-read.delim("balances_2014_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014d <- data2014d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2014e<-read.delim("balances_2014_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014e <- data2014e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2014e$CUENTA_801<-rm.outlier(data2014e$CUENTA_801, fill = T, median = T, opposite = F)
data2014f<-read.delim("balances_2014_6.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014f<- data2014f%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2014g<-read.delim("balances_2014_7.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014g <- data2014g%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2014h<-read.delim("balances_2014_8.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2014h<- data2014h%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2014 <- merge(data2014a, data2014b , all = T)
data2014 <- merge(data2014c, data2014 , all = T)
data2014 <- merge(data2014d, data2014 , all = T)
data2014 <- merge(data2014e, data2014 , all = T)
data2014 <- merge(data2014f, data2014 , all = T)
data2014 <- merge(data2014g, data2014 , all = T)
data2014 <- merge(data2014h, data2014 , all = T)
remove(data2014a)
remove(data2014b)
remove(data2014c)
remove(data2014d)
remove(data2014e)
remove(data2014f)
remove(data2014g)
remove(data2014h)

data2013a<-read.delim("balances_2013_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2013a <- data2013a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_41,CUENTA_4101, CUENTA_4102, CUENTA_4103, CUENTA_4110, CUENTA_4111, CUENTA_4112, CUENTA_4113,CUENTA_43,CUENTA_51,CUENTA_5201, CUENTA_5202,CUENTA_5204,CUENTA_5203,CUENTA_1,CUENTA_10103,CUENTA_520101, CUENTA_520201,CUENTA_520102, CUENTA_520202,CUENTA_60)
data2013b<-read.delim("balances_2013_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2013b<- data2013b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2013c<-read.delim("balances_2013_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2013c<- data2013c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2013 <- merge(data2013a, data2013b , all = T)
data2013 <- merge(data2013c, data2013 , all = T)
remove(data2013a)
remove(data2013b)
remove(data2013c)

data2012a<-read.delim("balances_2012_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1",quote="")
data2012a <- data2012a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_41,CUENTA_4101, CUENTA_4102, CUENTA_4103, CUENTA_4110, CUENTA_4111, CUENTA_4112, CUENTA_4113,CUENTA_43,CUENTA_51,CUENTA_5201, CUENTA_5202,CUENTA_5204,CUENTA_5203,CUENTA_1,CUENTA_10103,CUENTA_520101, CUENTA_520201,CUENTA_520102, CUENTA_520202,CUENTA_60)
data2012b<-read.delim("balances_2012_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2012b<- data2012b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2012c<-read.delim("balances_2012_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2012c<- data2012c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2012d<-read.delim("balances_2012_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2012d<- data2012d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2012 <- merge(data2012a, data2012b , all = T)
data2012 <- merge(data2012c, data2012 , all = T)
data2012 <- merge(data2012d, data2012 , all = T)
remove(data2012a)
remove(data2012b)
remove(data2012c)
remove(data2012d)

data2011a<-read.delim("balances_2011_1.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011a <- data2011a%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_369,CUENTA_411, CUENTA_412, CUENTA_413, CUENTA_414,CUENTA_415, CUENTA_416, CUENTA_426, CUENTA_427,CUENTA_441, CUENTA_442, CUENTA_443, CUENTA_444,CUENTA_445, CUENTA_446, CUENTA_454, CUENTA_455,CUENTA_601, CUENTA_602, CUENTA_603, CUENTA_604, CUENTA_606, CUENTA_607, CUENTA_608, CUENTA_609, CUENTA_610, CUENTA_611, CUENTA_612,CUENTA_601, CUENTA_602, CUENTA_603,CUENTA_605,CUENTA_797,CUENTA_715, CUENTA_716, CUENTA_717, CUENTA_718, CUENTA_719, CUENTA_720, CUENTA_721, CUENTA_722, CUENTA_723, CUENTA_724, CUENTA_737, CUENTA_738, CUENTA_739, CUENTA_740, CUENTA_742, CUENTA_743, CUENTA_744, CUENTA_765, CUENTA_766, CUENTA_767, CUENTA_768, CUENTA_781, CUENTA_782, CUENTA_783, CUENTA_784, CUENTA_785, CUENTA_786, CUENTA_787, CUENTA_788, CUENTA_789, CUENTA_790, CUENTA_791, CUENTA_792,CUENTA_725, CUENTA_726, CUENTA_727, CUENTA_728, CUENTA_729, CUENTA_730, CUENTA_731, CUENTA_732, CUENTA_733, CUENTA_734, CUENTA_735, CUENTA_736, CUENTA_769, CUENTA_770, CUENTA_771, CUENTA_772, CUENTA_773, CUENTA_774, CUENTA_775, CUENTA_776, CUENTA_777, CUENTA_778, CUENTA_779, CUENTA_780,CUENTA_745, CUENTA_746, CUENTA_747, CUENTA_748, CUENTA_749, CUENTA_750, CUENTA_751, CUENTA_752, CUENTA_753, CUENTA_754, CUENTA_755, CUENTA_756, CUENTA_757, CUENTA_758, CUENTA_759, CUENTA_760, CUENTA_761, CUENTA_762, CUENTA_763, CUENTA_764,CUENTA_399,CUENTA_325, CUENTA_326, CUENTA_327, CUENTA_328, CUENTA_329, CUENTA_330,CUENTA_716,CUENTA_720,CUENTA_801, CUENTA_802)
data2011b<-read.delim("balances_2011_2.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011b <- data2011b%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_369,CUENTA_411, CUENTA_412, CUENTA_413, CUENTA_414,CUENTA_415, CUENTA_416, CUENTA_426, CUENTA_427,CUENTA_441, CUENTA_442, CUENTA_443, CUENTA_444,CUENTA_445, CUENTA_446, CUENTA_454, CUENTA_455,CUENTA_601, CUENTA_602, CUENTA_603, CUENTA_604, CUENTA_606, CUENTA_607, CUENTA_608, CUENTA_609, CUENTA_610, CUENTA_611, CUENTA_612,CUENTA_601, CUENTA_602, CUENTA_603,CUENTA_605,CUENTA_797,CUENTA_715, CUENTA_716, CUENTA_717, CUENTA_718, CUENTA_719, CUENTA_720, CUENTA_721, CUENTA_722, CUENTA_723, CUENTA_724, CUENTA_737, CUENTA_738, CUENTA_739, CUENTA_740, CUENTA_742, CUENTA_743, CUENTA_744, CUENTA_765, CUENTA_766, CUENTA_767, CUENTA_768, CUENTA_781, CUENTA_782, CUENTA_783, CUENTA_784, CUENTA_785, CUENTA_786, CUENTA_787, CUENTA_788, CUENTA_789, CUENTA_790, CUENTA_791, CUENTA_792,CUENTA_725, CUENTA_726, CUENTA_727, CUENTA_728, CUENTA_729, CUENTA_730, CUENTA_731, CUENTA_732, CUENTA_733, CUENTA_734, CUENTA_735, CUENTA_736, CUENTA_769, CUENTA_770, CUENTA_771, CUENTA_772, CUENTA_773, CUENTA_774, CUENTA_775, CUENTA_776, CUENTA_777, CUENTA_778, CUENTA_779, CUENTA_780,CUENTA_745, CUENTA_746, CUENTA_747, CUENTA_748, CUENTA_749, CUENTA_750, CUENTA_751, CUENTA_752, CUENTA_753, CUENTA_754, CUENTA_755, CUENTA_756, CUENTA_757, CUENTA_758, CUENTA_759, CUENTA_760, CUENTA_761, CUENTA_762, CUENTA_763, CUENTA_764,CUENTA_399,CUENTA_325, CUENTA_326, CUENTA_327, CUENTA_328, CUENTA_329, CUENTA_330,CUENTA_716,CUENTA_720,CUENTA_801, CUENTA_802)
data2011c<-read.delim("balances_2011_3.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011c <- data2011c%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_41,CUENTA_4101, CUENTA_4102, CUENTA_4103, CUENTA_4109, CUENTA_4110, CUENTA_4111, CUENTA_4112,CUENTA_43,CUENTA_51,CUENTA_5201, CUENTA_5202,CUENTA_5204,CUENTA_5203,CUENTA_1,CUENTA_10103,CUENTA_520101, CUENTA_520201,CUENTA_520102, CUENTA_520202,CUENTA_60)
data2011d<-read.delim("balances_2011_4.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011d <- data2011d%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_41,CUENTA_4101, CUENTA_4102, CUENTA_4103, CUENTA_4110, CUENTA_4111, CUENTA_4112, CUENTA_4113,CUENTA_43,CUENTA_51,CUENTA_5201, CUENTA_5202,CUENTA_5204,CUENTA_5203,CUENTA_1,CUENTA_10103,CUENTA_520101, CUENTA_520201,CUENTA_520102, CUENTA_520202,CUENTA_60)
data2011e<-read.delim("balances_2011_5.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011e<- data2011e%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_10201,CUENTA_20103,CUENTA_20104, CUENTA_20106,CUENTA_20202,CUENTA_20203, CUENTA_20205,CUENTA_401,CUENTA_40101, CUENTA_40102, CUENTA_40103, CUENTA_40112, CUENTA_40113, CUENTA_40114, CUENTA_40115,CUENTA_403,CUENTA_501,CUENTA_50201, CUENTA_50202,CUENTA_50204,CUENTA_50203,CUENTA_1,CUENTA_10103,CUENTA_5020101, CUENTA_5020201,CUENTA_5020102, CUENTA_5020202,CUENTA_600)
data2011f<-read.delim("balances_2011_6.txt", header = T,sep="\t",dec= ",", na.strings = c("", NA), skipNul = T,fileEncoding="latin1")
data2011f<- data2011f%>%select(AÑO, EXPEDIENTE,RUC,NOMBRE,RAMA_ACTIVIDAD,DESCRIPCION_RAMA,CIIU,CUENTA_362, CUENTA_363, CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367, CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371, CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375, CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379, CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383, CUENTA_384, CUENTA_385, CUENTA_386,CUENTA_511, CUENTA_512, CUENTA_513, CUENTA_514,CUENTA_523, CUENTA_524, CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,CUENTA_553, CUENTA_554, CUENTA_555, CUENTA_556,CUENTA_563, CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567, CUENTA_568,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025, CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035, CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045, CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055, CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065, CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075, CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085, CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6001, CUENTA_6003, CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015, CUENTA_6017,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101, CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113, CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125, CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013, CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031, CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049, CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067, CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085, CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103, CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139, CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166, CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,  CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223, CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241, CUENTA_7247,CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113, CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062, CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077, CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092, CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107, CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125, CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140, CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155, CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,CUENTA_7173, CUENTA_7176, CUENTA_7179, CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191, CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,  CUENTA_7206, CUENTA_7209, CUENTA_7212, CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224, CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236, CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260, CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275, CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290, CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305, CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_499,CUENTA_339, CUENTA_340, CUENTA_341, CUENTA_342, CUENTA_343, CUENTA_344, CUENTA_345, CUENTA_346, CUENTA_347,CUENTA_7041,CUENTA_7047,CUENTA_801, CUENTA_802)
data2011 <- merge(data2011a, data2011b , all = T)
data2011 <- merge(data2011c, data2011 , all = T)
data2011 <- merge(data2011d, data2011 , all = T)
data2011 <- merge(data2011e, data2011 , all = T)
data2011 <- merge(data2011f, data2011 , all = T)
remove(data2011a)
remove(data2011b)
remove(data2011c)
remove(data2011d)
remove(data2011e)
remove(data2011f)

#He sacado la variable CUENTA_7205

#data2012<-read.delim("bal2012.txt", header = T,sep="\t", na.strings = c("", NA), skipNul = T, fileEncoding = "UTF-16")
#data2019<-read.table("bal2019.txt", header = T,sep="\t",quote="", skipNul = T, fileEncoding = "UCS-16")

#Reading in a zip data file (without unzipping it) - It does not work at all
#data2019<-read.table(unz("balances_2019.zip","bal2019.txt"),quote="",nrows = 30, skip = 1,header = T,sep="\t", skipNul = T, fileEncoding = "UTF-16")[,1:15]

#Note: do not use read.table without argument quote="" (It cannot get all data lines )

#Checking memory
#gc()
#rm()
#memory.limit() # Check currently set limit 
#memory.size()
#memory.size(max=T) # gives the amount of memory obtained by the OS
#memory.size(max=F) # gives the amount of memory being used

##Data wrangling
#Checking data structure
str(data2011)
str(data2012)
str(data2013)
str(data2014)
str(data2015)
str(data2016)
str(data2017)
str(data2018)
str(data2019)

#Variables characteristics
#split(names(data2018),sapply(data2018, function(x) paste(class(x), collapse=" ")))

#Find and drop duplicate elements for firms ID (RUC)
#Ruc is our intersection variable for merging
duplicated(data2017$RUC)#To find the position of duplicate elements
sum(duplicated(data2017$RUC))#count of number of duplicates in column
which(duplicated(data2017$RUC) | duplicated(data2017$RUC, fromLast = TRUE))#duplicates position
table(data2017$RUC)#the count of each data in column
as.data.frame((table(data2017$RUC)))#the frequency of each data in column
unique(data2017)#Data without duplicates
data2017 %>% distinct(RUC, .keep_all = TRUE)# Remove duplicated rows 
data2017[!duplicated(data2017$RUC), ] #Remove duplicates based on RUC column


data2019<-data2019[!duplicated(data2019$RUC), ]
data2018<-data2018[!duplicated(data2018$RUC), ]
data2017<-data2017[!duplicated(data2017$RUC), ]
data2016<-data2016[!duplicated(data2016$RUC), ]
data2015<-data2015[!duplicated(data2015$RUC), ]
data2014<-data2014[!duplicated(data2014$RUC), ]
data2013<-data2013[!duplicated(data2013$RUC), ]
data2012<-data2012[!duplicated(data2012$RUC), ]
data2011<-data2011[!duplicated(data2011$RUC), ]

sum(duplicated(data2019$RUC))
sum(duplicated(data2018$RUC))
sum(duplicated(data2017$RUC))
sum(duplicated(data2016$RUC))
sum(duplicated(data2015$RUC))
sum(duplicated(data2014$RUC))
sum(duplicated(data2013$RUC))
sum(duplicated(data2012$RUC))
sum(duplicated(data2011$RUC))

#Selecting variables of interest
library(tidyverse)

#ingresosdeexplotacioneur  numeroempleados  totalactivoeur  inmovilizadomaterialeur  existenciaseur  deudasconentidcreditolpeur  acreedoresalpeur  acreedoresacpeur  gastosdepersonaleur  sueldossalariosyasimilaeur  cargassocialeseur  serviciosexterioreseur  importenetocifranegociseur  otrosingresosexplotacioneur  resultadodeexplotacioneur  resultantesdeimpuestoseur  inmovilizadointangibleeur  distribucionmujeres  distribucionhombres  deudasconentidcreditocpeur,  i(firmnum)  j(year)

#From 2011 onwards variables are not similar across time (names and columns)
#Plan de cuentas and Formulario impuesto renta sociedades

##Merging all datasets in a master data
#joining data: I combine data based on common columns, as well as common rows.

#master data
masterdata <- merge(data2018, data2019 , all = T)
masterdata <- merge(data2017, masterdata , all = T)
masterdata <- merge(data2016, masterdata , all = T)
masterdata <- merge(data2015, masterdata , all = T)
masterdata <- merge(data2014, masterdata , all = T)
masterdata <- merge(data2013, masterdata , all = T)
masterdata <- merge(data2012, masterdata , all = T)
masterdata <- merge(data2011, masterdata , all = T)

#NOTE:
#Dataset merged by Marco Faytong and sent to me
#masterdata <-read.csv(file = 'masterdata.csv')
head(masterdata)
str(masterdata)

#library(tidyverse)
#NOTE:
#It has to be created new variables (but some of them have NAs and they can not be added up)
#First solution (Better Do not do this)
#Replacing NAs with zero
#masterdata[is.na(masterdata)] <- 0

#Other solution (good one) (This does not affect the original columns)
#masterdata<-masterdata %>%
#  mutate(newvar = select(., v1,v2,v3) %>% rowSums(na.rm = TRUE))

#or
#masterdata$newvar <- ifelse(is.na(masterdata$a),0,masterdata$a) +ifelse(is.na(masterdata$b),0,masterdata$b)
# -ifelse(is.na(masterdata$c),0,masterdata$c)

#Creating new variables for study

attach(masterdata)

names(masterdata)[1] <- "year"

#Activos totales
masterdata<-masterdata %>%
  mutate(totalactivo = select(., CUENTA_399, CUENTA_1,CUENTA_499) %>% rowSums(na.rm = TRUE))

#Inventario
masterdata<-masterdata %>%
  mutate(existencias = select(.,CUENTA_10103,CUENTA_325,CUENTA_326,
                                CUENTA_327,CUENTA_328,CUENTA_329,
                                CUENTA_330,CUENTA_339,CUENTA_340,
                                CUENTA_341,CUENTA_342,CUENTA_343,
                                CUENTA_344,CUENTA_345,CUENTA_346,
                                CUENTA_347,CUENTA_331,CUENTA_332,
                                CUENTA_333,CUENTA_334,CUENTA_335,
                                CUENTA_336,CUENTA_337,CUENTA_338) %>% rowSums(na.rm = TRUE))

#Obligaciones financieras a largo plazo
masterdata<-masterdata %>%
  mutate(deudasconentidcreditolp = select(., CUENTA_20203,CUENTA_20205,CUENTA_445,
                                      CUENTA_446, CUENTA_454, CUENTA_455,CUENTA_545,
                                      CUENTA_546, CUENTA_555, CUENTA_556,CUENTA_563,
                                      CUENTA_564, CUENTA_565, CUENTA_566, CUENTA_567,
                                      CUENTA_568) %>% rowSums(na.rm = TRUE))

#Acreedores a largo plazo
masterdata<-masterdata %>%
  mutate(acreedoresalp = select(.,CUENTA_20202,CUENTA_441, CUENTA_442,CUENTA_443,
                                CUENTA_444,CUENTA_541, CUENTA_542, CUENTA_543,
                                CUENTA_544,CUENTA_553, CUENTA_554, CUENTA_555,
                                CUENTA_556) %>% rowSums(na.rm = TRUE))

#Acreedores a corto plazo
masterdata<-masterdata %>%
  mutate(acreedoresacp = select(., CUENTA_20103, CUENTA_411, CUENTA_412, CUENTA_413,
                                    CUENTA_414,CUENTA_511, CUENTA_512, CUENTA_513,
                                    CUENTA_514) %>% rowSums(na.rm = TRUE))

#Sueldos y salarios
masterdata<-masterdata %>%
  mutate(sueldossalariosyasimila = select(., CUENTA_5020101,CUENTA_5020201,
                                          CUENTA_520101,CUENTA_520201,CUENTA_716,
                                          CUENTA_7041,#CUENTA_7132
                                          ) %>% rowSums(na.rm = TRUE))

#Seguridad social
masterdata<-masterdata %>%
  mutate(cargassociales = select(., CUENTA_5020102,CUENTA_5020202,
                                   CUENTA_520102,CUENTA_520202,CUENTA_720,
                                  CUENTA_7047,CUENTA_7152
                                   ) %>% rowSums(na.rm = TRUE))

#Coste laboral = Salarios + Seguridad social
masterdata<-masterdata %>%
  mutate(gastosdepersonal = select(., sueldossalariosyasimila,cargassociales) %>% rowSums(na.rm = TRUE))

#Ingresos de explotacion
masterdata<-masterdata %>%
  mutate(ingresosdeexplotacion = select(.,CUENTA_601, CUENTA_602, CUENTA_603, CUENTA_604, CUENTA_606,
                                        CUENTA_607, CUENTA_608, CUENTA_609, CUENTA_610, CUENTA_611,
                                        CUENTA_612,CUENTA_41,CUENTA_6001, CUENTA_6003, CUENTA_6005,
                                        CUENTA_6007, CUENTA_6009, CUENTA_6011, CUENTA_6013, CUENTA_6015,
                                        CUENTA_6017, CUENTA_6019, CUENTA_6021, CUENTA_6023, CUENTA_6025,
                                        CUENTA_6027, CUENTA_6029, CUENTA_6031, CUENTA_6033, CUENTA_6035,
                                        CUENTA_6037, CUENTA_6039, CUENTA_6041, CUENTA_6043, CUENTA_6045,
                                        CUENTA_6047, CUENTA_6049, CUENTA_6051, CUENTA_6053, CUENTA_6055,
                                        CUENTA_6057, CUENTA_6059, CUENTA_6061, CUENTA_6063, CUENTA_6065,
                                        CUENTA_6067, CUENTA_6069, CUENTA_6071, CUENTA_6073, CUENTA_6075,
                                        CUENTA_6077, CUENTA_6079, CUENTA_6081, CUENTA_6083, CUENTA_6085,
                                        CUENTA_6087, CUENTA_6089, CUENTA_6091, CUENTA_6093,CUENTA_6011,
                                        CUENTA_6021, CUENTA_6031, CUENTA_6041, CUENTA_6051, CUENTA_6061,
                                        CUENTA_6071, CUENTA_6081, CUENTA_6091, CUENTA_6101, CUENTA_6111,
                                        CUENTA_401
                                        ) %>% rowSums(na.rm = TRUE))

#Importe neto cifra de negocios
masterdata<-masterdata %>%
  mutate(importenetocifranegocis = select(., CUENTA_601, CUENTA_602, CUENTA_603,CUENTA_4101,
                                          CUENTA_4102, CUENTA_4103, CUENTA_4109, CUENTA_4110,
                                          CUENTA_4111, CUENTA_4112,CUENTA_4113,CUENTA_40101,
                                          CUENTA_40102, CUENTA_40103,CUENTA_40112,CUENTA_40113,
                                          CUENTA_40114, CUENTA_40115,CUENTA_6011,CUENTA_6021,
                                          CUENTA_6031, CUENTA_6041,CUENTA_6001, CUENTA_6003,
                                          CUENTA_6005, CUENTA_6007, CUENTA_6009, CUENTA_6011,
                                          CUENTA_6013, CUENTA_6015, CUENTA_6017
                                          ) %>% rowSums(na.rm = TRUE))

#Otros ingresos de explotacion
masterdata$otrosingresosexplotacion <- ifelse(is.na(masterdata$ingresosdeexplotacion),0,masterdata$ingresosdeexplotacion)-
                                       ifelse(is.na(masterdata$importenetocifranegocis),0,masterdata$importenetocifranegocis)

#masterdata<-masterdata %>%
 # mutate(otrosingresosexplotacion = select(.,CUENTA_40104,CUENTA_40105,CUENTA_40106,CUENTA_40107,
 #                                          CUENTA_40108,CUENTA_40109,CUENTA_40116,
  #                                         CUENTA_4104,CUENTA_4105,CUENTA_4106,
   #                                        CUENTA_4107,CUENTA_4108
    #                                       ) %>% rowSums(na.rm = TRUE))

#Ingresos de explotacion
#masterdata<-masterdata %>%
#  mutate(ingresosdeexplotacion = select(., importenetocifranegocis,otrosingresosexplotacion) %>% rowSums(na.rm = TRUE))

#Gastos financieros y no operacionales
masterdata<-masterdata %>%
  mutate(gastofinanynooperacion = select(., CUENTA_745, CUENTA_746, CUENTA_747, CUENTA_748, CUENTA_749,
                                         CUENTA_750, CUENTA_751, CUENTA_752, CUENTA_753, CUENTA_754,
                                         CUENTA_755, CUENTA_756, CUENTA_757, CUENTA_758, CUENTA_759,
                                         CUENTA_760, CUENTA_761, CUENTA_762, CUENTA_763, CUENTA_764,
                                         CUENTA_5203,CUENTA_7251, CUENTA_7254, CUENTA_7257, CUENTA_7260,
                                         CUENTA_7263, CUENTA_7266, CUENTA_7269, CUENTA_7272, CUENTA_7275,
                                         CUENTA_7278, CUENTA_7281, CUENTA_7284, CUENTA_7287, CUENTA_7290,
                                         CUENTA_7293, CUENTA_7296, CUENTA_7299, CUENTA_7302, CUENTA_7305,
                                         CUENTA_7308, CUENTA_7311, CUENTA_7314,CUENTA_7302, CUENTA_7312,
                                         CUENTA_7322, CUENTA_7332, CUENTA_7342, CUENTA_7352, CUENTA_7362,
                                         CUENTA_7372, CUENTA_7382, CUENTA_7392,CUENTA_50203
                                         ) %>% rowSums(na.rm = TRUE))  

#Gastos operacionales (explotaci?n)
masterdata<-masterdata %>%
  mutate(gastosexplotacion = select(.,CUENTA_715, CUENTA_716, CUENTA_717, CUENTA_718, CUENTA_719,
                                      CUENTA_720, CUENTA_721, CUENTA_722, CUENTA_723, CUENTA_724,
                                      CUENTA_737, CUENTA_738, CUENTA_739, CUENTA_740, CUENTA_742,
                                      CUENTA_743, CUENTA_744, CUENTA_765, CUENTA_766, CUENTA_767,
                                      CUENTA_768, CUENTA_781, CUENTA_782, CUENTA_783, CUENTA_784,
                                      CUENTA_785, CUENTA_786, CUENTA_787, CUENTA_788, CUENTA_789,
                                      CUENTA_790, CUENTA_791, CUENTA_792,CUENTA_5201, CUENTA_5202,
                                      CUENTA_7008, CUENTA_7041, CUENTA_7044, CUENTA_7047, CUENTA_7113,
                                      CUENTA_7050, CUENTA_7053, CUENTA_7056, CUENTA_7059, CUENTA_7062,
                                      CUENTA_7065, CUENTA_7068, CUENTA_7071, CUENTA_7074, CUENTA_7077,
                                      CUENTA_7080, CUENTA_7083, CUENTA_7086, CUENTA_7089, CUENTA_7092,
                                      CUENTA_7095, CUENTA_7098, CUENTA_7101, CUENTA_7104, CUENTA_7107,
                                      CUENTA_7110, CUENTA_7116, CUENTA_7119, CUENTA_7122, CUENTA_7125,
                                      CUENTA_7128, CUENTA_7131, CUENTA_7134, CUENTA_7137, CUENTA_7140,
                                      CUENTA_7143, CUENTA_7146, CUENTA_7149, CUENTA_7152, CUENTA_7155,
                                      CUENTA_7158, CUENTA_7161, CUENTA_7164, CUENTA_7167, CUENTA_7170,
                                      CUENTA_50201, CUENTA_50202,CUENTA_7032, CUENTA_7132, CUENTA_7142,
                                      CUENTA_7152, CUENTA_7162, CUENTA_7172, CUENTA_7242, CUENTA_7252,
                                      CUENTA_7262, CUENTA_7272, CUENTA_7282, CUENTA_7292, CUENTA_7402,
                                      CUENTA_7412, CUENTA_7502, CUENTA_7512, CUENTA_7522, CUENTA_7542,
                                      CUENTA_7562
                                      ) %>% rowSums(na.rm = TRUE))  

#otros gastos operacionales (explotaci?n)
masterdata<-masterdata %>%
  mutate(otrosgastosoperacionales = select(.,CUENTA_725, CUENTA_726, CUENTA_727, CUENTA_728,
                                           CUENTA_729, CUENTA_730, CUENTA_731, CUENTA_732,
                                           CUENTA_733, CUENTA_734, CUENTA_735, CUENTA_736,
                                           CUENTA_769, CUENTA_770, CUENTA_771, CUENTA_772,
                                           CUENTA_773, CUENTA_774, CUENTA_775, CUENTA_776,
                                           CUENTA_777, CUENTA_778, CUENTA_779, CUENTA_780,
                                           CUENTA_5204,CUENTA_7173, CUENTA_7176, CUENTA_7179,
                                           CUENTA_7182, CUENTA_7185, CUENTA_7188, CUENTA_7191,
                                           CUENTA_7194, CUENTA_7197, CUENTA_7200, CUENTA_7203,
                                           CUENTA_7206, CUENTA_7209, CUENTA_7212,
                                           CUENTA_7215, CUENTA_7218, CUENTA_7221, CUENTA_7224,
                                           CUENTA_7227, CUENTA_7230, CUENTA_7233, CUENTA_7236,
                                           CUENTA_7239, CUENTA_7242, CUENTA_7245, CUENTA_7248,
                                           CUENTA_50204,CUENTA_7182, CUENTA_7192, CUENTA_7202,
                                           CUENTA_7212, CUENTA_7222, CUENTA_7232, CUENTA_7422,
                                           CUENTA_7432, CUENTA_7442, CUENTA_7452, CUENTA_7462,
                                           CUENTA_7472, CUENTA_7482, CUENTA_7492, CUENTA_7572,
                                           CUENTA_7582, CUENTA_7592
                                      ) %>% rowSums(na.rm = TRUE))  

#Gastos operacionales (explotaci?n) totales
masterdata$gastosoperacionales <- ifelse(is.na(masterdata$gastosexplotacion),0,masterdata$gastosexplotacion)+
  ifelse(is.na(masterdata$otrosgastosoperacionales),0,masterdata$otrosgastosoperacionales)

#Coste de venta - CUENTA_7205
masterdata<-masterdata %>%
  mutate(costeventa = select(.,CUENTA_797,CUENTA_51,CUENTA_501,CUENTA_7010, CUENTA_7011,
                             CUENTA_7021, CUENTA_7031, CUENTA_7041, CUENTA_7051, CUENTA_7061, CUENTA_7071,
                             CUENTA_7081, CUENTA_7091, CUENTA_7101, CUENTA_7111, CUENTA_7121, CUENTA_7131,
                             CUENTA_7141, CUENTA_7151, CUENTA_7161, CUENTA_7171, CUENTA_7181, CUENTA_7191,
                             CUENTA_7201, CUENTA_7211, CUENTA_7221, CUENTA_7231, CUENTA_7241, CUENTA_7251,
                             CUENTA_7262, CUENTA_7271, CUENTA_7281, CUENTA_7291, CUENTA_7301, CUENTA_7311,
                             CUENTA_7321, CUENTA_7331, CUENTA_7341, CUENTA_7351, CUENTA_7361, CUENTA_7371,
                             CUENTA_7381, CUENTA_7391, CUENTA_7401, CUENTA_7411, CUENTA_7421, CUENTA_7431,
                             CUENTA_7441, CUENTA_7451, CUENTA_7481, CUENTA_7491, CUENTA_7501, CUENTA_7511,
                             CUENTA_7521, CUENTA_7531, CUENTA_7551, CUENTA_7561, CUENTA_7571, CUENTA_7581,
                             CUENTA_7591,CUENTA_7001, CUENTA_7004, CUENTA_7007, CUENTA_7010, CUENTA_7013,
                             CUENTA_7016, CUENTA_7019, CUENTA_7022, CUENTA_7025, CUENTA_7028, CUENTA_7031,
                             CUENTA_7034, CUENTA_7037, CUENTA_7040, CUENTA_7043, CUENTA_7046, CUENTA_7049,
                             CUENTA_7052, CUENTA_7055, CUENTA_7058, CUENTA_7061, CUENTA_7064, CUENTA_7067,
                             CUENTA_7070, CUENTA_7073, CUENTA_7076, CUENTA_7079, CUENTA_7082, CUENTA_7085,
                             CUENTA_7088, CUENTA_7091, CUENTA_7094, CUENTA_7097, CUENTA_7100, CUENTA_7103,
                             CUENTA_7106, CUENTA_7109, CUENTA_7115, CUENTA_7124, CUENTA_7127, CUENTA_7139,
                             CUENTA_7140, CUENTA_7142,CUENTA_7145, CUENTA_7160, CUENTA_7163, CUENTA_7166,
                             CUENTA_7169, CUENTA_7190, CUENTA_7196, CUENTA_7199, CUENTA_7202,
                             CUENTA_7208, CUENTA_7211, CUENTA_7214, CUENTA_7217, CUENTA_7220, CUENTA_7223,
                             CUENTA_7226, CUENTA_7229, CUENTA_7232, CUENTA_7235, CUENTA_7238, CUENTA_7241,
                             CUENTA_7247
                               ) %>% rowSums(na.rm = TRUE))

#Ingresos financieros y no operaciones
masterdata<-masterdata %>%
  mutate(ingresfinanynooperacion = select(.,CUENTA_605,CUENTA_43,CUENTA_6095, CUENTA_6097, CUENTA_6099, CUENTA_6101,
                                          CUENTA_6103, CUENTA_6105, CUENTA_6107, CUENTA_6109, CUENTA_6111, CUENTA_6113,
                                          CUENTA_6115, CUENTA_6117, CUENTA_6119, CUENTA_6121, CUENTA_6123, CUENTA_6125,
                                          CUENTA_6127, CUENTA_6129, CUENTA_6131, CUENTA_6133, CUENTA_6135,CUENTA_403,
                                          CUENTA_6061
                                          ) %>% rowSums(na.rm = TRUE))

#Beneficio antes de impuestos
masterdata<-masterdata %>%
  mutate(resultantesdeimpuestos = select(.,CUENTA_801, CUENTA_802,CUENTA_60,CUENTA_600
                                         ) %>% rowSums(na.rm = TRUE))

#Resultado de explotaci?n
masterdata$resultadodeexplotacion <- ifelse(is.na(masterdata$resultantesdeimpuestos),0,masterdata$resultantesdeimpuestos)+ 
  ifelse(is.na(masterdata$gastofinanynooperacion),0,masterdata$gastofinanynooperacion)-
  ifelse(is.na(masterdata$ingresfinanynooperacion),0,masterdata$ingresfinanynooperacion)

#Propiedad, Planta y Equipo
masterdata<-masterdata %>%
  mutate(inmovilizadomaterial = select(.,CUENTA_369,CUENTA_10201,CUENTA_350, CUENTA_351,
                                       CUENTA_352, CUENTA_353, CUENTA_354, CUENTA_355,
                                       CUENTA_356, CUENTA_357, CUENTA_358, CUENTA_359,
                                       CUENTA_360, CUENTA_361, CUENTA_362, CUENTA_363,
                                       CUENTA_364, CUENTA_365, CUENTA_366, CUENTA_367,
                                       CUENTA_368, CUENTA_369, CUENTA_370, CUENTA_371,
                                       CUENTA_372, CUENTA_373, CUENTA_374, CUENTA_375,
                                       CUENTA_376, CUENTA_377, CUENTA_378, CUENTA_379,
                                       CUENTA_380, CUENTA_381, CUENTA_382, CUENTA_383,
                                       CUENTA_384, CUENTA_385, CUENTA_386 ) %>% rowSums(na.rm = TRUE))

#Obligaciones financieras a corto plazo
masterdata<-masterdata %>%
  mutate(deudasconentidcreditocp = select(.,CUENTA_20104,CUENTA_20106,CUENTA_415, CUENTA_416,
                                          CUENTA_426, CUENTA_427, CUENTA_523, CUENTA_524, 
                                          CUENTA_525, CUENTA_526, CUENTA_527, CUENTA_528,
                                          CUENTA_515, CUENTA_516, CUENTA_532, CUENTA_533 ) %>% rowSums(na.rm = TRUE))

##Checking variables of interest
#We can use this
#by(masterdata$var, masterdata$group, function(x)
#  c(N=length(x),mean=mean(x),median=median(x),max=max(x),min=min(x),quantile(x,c(.25,.75))))

#or

#This option is not efficient
#masterdata %>%                               # Summary by group using dplyr
#  group_by(group) %>% 
#  summarize(N=length(var),
#            mean = mean(var),
#            min = min(var),
#            q1 = quantile(var, 0.25),
#            median = median(var),
#            q3 = quantile(var, 0.75),
#            max = max(var))

#I created a function to display a descriptive statistics
library(tidyverse)
tabstat <- function(dataframe, grouping_var, column_name){
  
  dataframe %>%
    group_by({{grouping_var}}) %>%  
    summarise(N := length({{column_name}}),
              Mean := mean({{column_name}}, na.rm = TRUE),
              Min := min({{column_name}}, na.rm = TRUE),
              Q1 := quantile({{column_name}},0.25, na.rm = TRUE),
              Median := quantile({{column_name}},0.50, na.rm = TRUE),
              Q3 := quantile({{column_name}},0.75, na.rm = TRUE),
              Sum := sum({{column_name}}, na.rm = TRUE),
              Max := max({{column_name}}, na.rm = TRUE))
}

tabstat(masterdata,year,ingresosdeexplotacion)
tabstat(masterdata,year,totalactivo)
tabstat(masterdata,year,inmovilizadomaterial)
tabstat(masterdata,year,existencias)
tabstat(masterdata,year,deudasconentidcreditolp)
tabstat(masterdata,year,acreedoresalp)
tabstat(masterdata,year,acreedoresacp)
tabstat(masterdata,year,gastosdepersonal)
tabstat(masterdata,year,sueldossalariosyasimila)
tabstat(masterdata,year,cargassociales)
tabstat(masterdata,year,importenetocifranegocis)
tabstat(masterdata,year,otrosingresosexplotacion)
tabstat(masterdata,year,gastosexplotacion)
tabstat(masterdata,year,gastosoperacionales)
tabstat(masterdata,year,otrosgastosoperacionales)
tabstat(masterdata,year,resultadodeexplotacion)
tabstat(masterdata,year,resultantesdeimpuestos)
tabstat(masterdata,year,deudasconentidcreditocp)
tabstat(masterdata,year,costeventa)

#Plotting variables of interest
library(ggplot2)
library(reshape2)
library(lubridate)
library(dplyr)
library(plotly)

ggplot(data = masterdata) + 
  geom_bar(mapping = aes(x = RAMA_ACTIVIDAD))

vars <- masterdata[,c(1:7,558:578)] %>%
   select(everything())%>%
  select(-EXPEDIENTE,-RUC,-NOMBRE,-RAMA_ACTIVIDAD,-DESCRIPCION_RAMA,-CIIU)%>%
  group_by(year)%>%
  summarise_each(list(sum))

vars <- melt(vars,id.vars = "year")

ggplot(vars,aes(x=year,y=value,group=variable))+
  geom_area(aes(color=variable,fill=variable),alpha=0.2)+
  theme(legend.position = "bottom")+theme_minimal()

ggplot(data = vars, aes(x = year, y = value)) +
  geom_line() +
  facet_wrap(facets = vars(variable))+facet_wrap(variable ~ ., scales="free")

sectorwage <- masterdata %>%
   select(year,RAMA_ACTIVIDAD,sueldossalariosyasimila)%>%
  group_by(RAMA_ACTIVIDAD, year)%>%
  summarise_each(list(sum))

ggplot(data = sectorwage, aes(x = year, y = sueldossalariosyasimila)) +
  geom_line() +
  facet_wrap(facets = vars(RAMA_ACTIVIDAD))+facet_wrap(RAMA_ACTIVIDAD ~ ., scales="free")
  
#Preparing panel data (RUC-year)
library(plm) #Linear model for panel data
#masterdata <- plm.data(masterdata, c("RUC","year"))

masterdata<-pdata.frame(masterdata,index = c("RUC","year"))

#Reducing data size with only variables of interest
masterdata<-masterdata %>% select(1:7,558:578)

remove.packages("dplyr")
install.packages("dplyr",dependencies=TRUE)
library(tidyverse)

#Gross Domestic Product
library(rvest)
library(plyr)

piburl <- "https://datosmacro.expansion.com/pib/ecuador"
pibfile<-read_html(piburl)
pibtables<-html_nodes(pibfile, "table")
length(pibtables)
sapply(pibtables, class)
sapply(pibtables, function(x) dim(html_table(x, fill = TRUE)))
pib <- html_table(pibtables[1], fill = T)
pib <-lapply(pib, setNames, nm = c("year","piba","pibb", "GDPGR") ) #GDPGROWTH in ammount and growth
pib <-pib[[1]][,c(1,4)] #GDPGROWTH just with growth

#to convert to numeric values GDPGROWTH
pib<-pib %>%
  mutate(GDPGR=sub(",", ".", pib$GDPGR))
pib<-pib %>%
  mutate(GDPGR=sub("%", "", pib$GDPGR))
pib<-pib %>%
  mutate(GDPGR = as.numeric(pib$GDPGR))

masterdata <- join(masterdata, pib) #This function merge data with the same row order of the original

#Updating values: Social security contributions, wages, operating income (Harmonised inflation)
#IPC=Inflation
#IPC link: https://databank.bancomundial.org/reports.aspx?source=2&series=FP.CPI.TOTL.ZG&country=ECU

ipcr=c(1,5.1,2.7,3.6,4,1.7,0.4,-0.2,0.3)# IPC rates (first value always is one)
m<- (1+ipcr/100)
matrix <- matrix(1,nrow = 9,ncol = 9) #Matrix of 1
matrix[upper.tri(matrix,diag = T)] <- 0  #Triangular Matrix
ipcm<-matrix*m+t(matrix)+diag(9) #IPC rates matrix
ipcharm <-cumprod(data.frame(ipcm))# Harmonised IPC matrix
ipcharm[9,] #rows of interest
ipc<-data.frame(year=c(2011,2012,2013,2014,2015,2016,2017,2018,2019),ipc=c(as.matrix(ipcharm[8,])))
ipc # Harmonised IPC

masterdata <- join(masterdata, ipc) #This function merge data with the same row order of the original

#Updating variables
masterdata$cargassocialesa<-masterdata$cargassociales*masterdata$ipc
masterdata$sueldossalariosyasimila<-masterdata$sueldossalariosyasimila*masterdata$ipc
masterdata$gastosdepersonal<-masterdata$gastosdepersonal*masterdata$ipc
masterdata$importenetocifranegocis<-masterdata$importenetocifranegocis*masterdata$ipc
masterdata$totalactivo<-masterdata$totalactivo*masterdata$ipc

#Building variables - financial indicators
masterdata$SSCSALE <- (masterdata$cargassociales / masterdata$importenetocifranegocis ) * 100
masterdata$SSCWAGE <- (masterdata$cargassociales / masterdata$sueldossalariosyasimila) * 100
masterdata$WAGETSALE <- (masterdata$sueldossalariosyasimila / masterdata$importenetocifranegocis) * 100
masterdata$WAGCTSALE <- (masterdata$gastosdepersonal / masterdata$importenetocifranegocis ) * 100
masterdata$BANKDEBTTA <- ((masterdata$deudasconentidcreditolp + masterdata$deudasconentidcreditocp) / masterdata$totalactivo) * 100
masterdata$DEBTTA <- ((masterdata$acreedoresalp + masterdata$acreedoresacp) / masterdata$totalactivo ) * 100
masterdata$PPETOTA <- (masterdata$inmovilizadomaterial / masterdata$totalactivo) * 100
masterdata$INVTOTA <- (masterdata$existencias / masterdata$totalactivo) * 100
masterdata$ROA <- (masterdata$resultadodeexplotacion / masterdata$totalactivo) * 100
masterdata$lnSSCgr <- log(masterdata$cargassociales / lag(masterdata$cargassociales,1))
masterdata$lnWAGEgr <- log(masterdata$sueldossalariosyasimila / lag(masterdata$sueldossalariosyasimila,1))
masterdata$REVGROWTH <- masterdata$importenetocifranegocis / lag(masterdata$importenetocifranegocis,1)
masterdata$lnREVgr <- log(masterdata$importenetocifranegocis / lag(masterdata$importenetocifranegocis,1) )
masterdata$lnWAGCgr <- log(masterdata$gastosdepersonal / lag(masterdata$gastosdepersonal,1))
masterdata$TAtREV <- masterdata$totalactivo / masterdata$importenetocifranegocis
masterdata$lnTA <- log(masterdata$totalactivo )
masterdata$lnSALE <- log(masterdata$importenetocifranegocis)

#Creating Dummy variables (Period of labor reform)
masterdata$REF2016<-ifelse((as.numeric(levels(masterdata$year))[masterdata$year]) >= 2016, 1, 0)
#masterdata$REF2016<-ifelse(masterdata$year >= 2016, 1, 0)

#creating interactions
masterdata$REF2016lnREVgr <- masterdata$REF2016 * masterdata$lnREVgr
masterdata$REF2016lnWAGEgr <- masterdata$REF2016 * masterdata$lnWAGEgr

#Dropping negative values or missings in total assets, revenues, wages or SSC
masterdata<-masterdata[!(masterdata$totalactivo < 0), ] 
masterdata<-masterdata[!(masterdata$importenetocifranegocis <= 0), ] 
masterdata<-masterdata[!(masterdata$gastosdepersonal <= 0 & !is.na(masterdata$gastosdepersonal)), ] 
masterdata<-masterdata[!(masterdata$sueldossalariosyasimila <= 0 & !is.na(masterdata$sueldossalariosyasimila)), ]
masterdata<-masterdata[!(masterdata$cargassociales <= 0 & !is.na(masterdata$cargassociales)), ] 

#Dropping revenues increases above 50% or missing
masterdata<-masterdata[!((masterdata$importenetocifranegocis/lag(masterdata$importenetocifranegocis,1)) > 1.5 & !is.na(masterdata$importenetocifranegocis/lag(masterdata$importenetocifranegocis,1))),]

#Dropping revenues decreases above 50% or missing
masterdata<-masterdata[!((masterdata$importenetocifranegocis/lag(masterdata$importenetocifranegocis,1)) < 0.5),]

#Dropping NAs for required variables
masterdata<-masterdata[!is.na(masterdata$TAtREV), ]
masterdata<-masterdata[!is.na(masterdata$WAGETSALE), ]
masterdata<-masterdata[!is.na(masterdata$DEBTTA), ]
masterdata<-masterdata[!is.na(masterdata$PPETOTA), ]
masterdata<-masterdata[!is.na(masterdata$lnTA), ]
masterdata<-masterdata[!is.na(masterdata$GDPGR), ]
masterdata<-masterdata[!is.na(masterdata$ROA), ]
masterdata<-masterdata[!is.na(masterdata$lnWAGEgr), ]
masterdata<-masterdata[!is.na(masterdata$lnREVgr), ]
masterdata <- masterdata[!is.infinite(masterdata$lnWAGEgr),]
masterdata <- masterdata[!is.infinite(masterdata$lnREVgr),]

#masterdata <- masterdata[is.finite(rowSums(masterdata)),] #removes also rows containing NA values if not done

#Winsorizing estimated variables to 5 %
library(DescTools)

masterdata<-masterdata %>%
  mutate(wlnWAGEgr = DescTools::Winsorize(lnWAGEgr,val = quantile(lnWAGEgr,probs = c(0.05, 0.95), na.rm = TRUE)),
          wREF2016lnWAGEgr = DescTools::Winsorize(REF2016lnWAGEgr,val = quantile(REF2016lnWAGEgr,probs = c(0.05, 0.95), na.rm = TRUE)),
          wREF2016lnREVgr = DescTools::Winsorize(REF2016lnREVgr,val = quantile(REF2016lnREVgr,probs = c(0.05, 0.95), na.rm = TRUE)),
          wlnREVgr = DescTools::Winsorize(lnREVgr,val = quantile(lnREVgr,probs = c(0.05, 0.95), na.rm = TRUE)),
          wTAtREV = DescTools::Winsorize(TAtREV,val = quantile(TAtREV,probs = c(0.05, 0.95), na.rm = TRUE)),
          wWAGCTSALE = DescTools::Winsorize(WAGCTSALE,val = quantile(WAGCTSALE,probs = c(0.05, 0.95), na.rm = TRUE)),
          wWAGETSALE = DescTools::Winsorize(WAGETSALE,val = quantile(WAGETSALE,probs = c(0.05, 0.95), na.rm = TRUE)),
          wDEBTTA = DescTools::Winsorize(DEBTTA,val = quantile(DEBTTA,probs = c(0.05, 0.95), na.rm = TRUE)),
          wPPETOTA = DescTools::Winsorize(PPETOTA,val = quantile(PPETOTA,probs = c(0.05, 0.95), na.rm = TRUE)),
          wROA = DescTools::Winsorize(ROA,val = quantile(ROA,probs = c(0.05, 0.95), na.rm = TRUE)),
          wlnTA = DescTools::Winsorize(lnTA,val = quantile(lnTA,probs = c(0.05, 0.95), na.rm = TRUE)),
          wlnSSCgr = DescTools::Winsorize(lnSSCgr,val = quantile(lnSSCgr,probs = c(0.05, 0.95), na.rm = TRUE)),
          wlnWAGCgr = DescTools::Winsorize(lnWAGCgr,val = quantile(lnWAGCgr,probs = c(0.05, 0.95), na.rm = TRUE)))

sum(is.na(masterdata$lnWAGEgr))
sum(is.infinite(masterdata$lnWAGEgr))
sum(is.nan(masterdata$lnWAGEgr))

#aggregate(masterdata["wWAGETSALE"],by=masterdata["year"],sum)
#Checking dataset characteristics
is.data.frame(masterdata)  #dataframe
ncol(masterdata)   #column numbers
objects(masterdata)#objects inside
dim(masterdata)  #dimensions)
colnames(masterdata) #column names
mean(masterdata$cargassocialesact)
sapply(masterdata$cargassocialesact, mean, na.rm= T)
summary(masterdata)
str(masterdata)
head(masterdata)

#Exporting masterdata set in csv format
#write.csv(masterdata,"C:/Users/LaSalle/Desktop/José Luis/El Quantificador/Datos/masterdata.csv", row.names = FALSE)
#masterdata <-read.csv(file = 'masterdata.csv')
library(plm) #Linear model for panel data
masterdata<-pdata.frame(masterdata,index = c("RUC","year"))

#Exploratory Data Analysis

#Correlation analysis

library(GGally)
library(Hmisc)

#rcorr(as.matrix(masterdata[,c(29:47,54:68)]))

# Check correlations (as scatterplots), distribution and print corrleation coefficient 
#ggpairs(masterdata[,c(45,54,57:66)], title="correlogram with ggpairs()") 

#ggpairs(masterdata, columns = c(45,54,57:66), ggplot2::aes(colour=REF2016)) 

##Models selection
library(lmtest)
library(sandwich)
library(stargazer)
library(foreign)

#Proposed Models
#WAGC (Costes salariales)

#note:
#if we are using using xtreg fixed effects in either vce cluster or robust, then they are the same.
#If we specify -xtreg, fe vce(robust)-, Stata re-interprets that to -xtreg, fe vce(cluster panelvar).
#The -vce(robust)- requires that observations be independent in order for it to be valid,
#whereas vce(cluster groupvar) accommodates and adjusts for correlation of observations within values of groupvar.
#vce(robust) uses the robust or sandwich estimator of variance

#Info:
#https://data.princeton.edu/wws509/r/robust
#https://www.econometrics-with-r.org/rwpd.html
#https://www.princeton.edu/~otorres/Panel101R.pdf

# wlnWAGCgr wlnREVgr wREF2010lnREVgr wREF2012lnREVgr wREVNUMEMPL wTAtREV wWAGETSALE wDEBTTA wPPETOTA wROAt wlnTA GDPGR  i.NACE2di , fe vce(robust)
#sum(is.na(masterdata$RUC))
#masterdata<-masterdata[!is.na(masterdata$RUC), ]
# Estimate the fixed effects regression with plm()

wlnWAGEgrfe <- plm(wlnWAGEgr ~  wlnREVgr + REF2016 + wREF2016lnREVgr + wTAtREV + wWAGETSALE + wDEBTTA +
                  wPPETOTA + wROA + wlnTA + GDPGR, 
                    data = masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016,2017,2018,2019), ],
                    index = c("RUC", "year"), 
                    model = "within")

wlnSSCgrfe <- plm(wlnSSCgr ~ wTAtREV + wWAGETSALE + wDEBTTA + wPPETOTA + wROA +
                   wlnTA + GDPGR + wlnWAGEgr + REF2016 + wREF2016lnWAGEgr, 
                  data =  masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016,2017,2018,2019), ],
                   index = c("RUC", "year"), 
                   model = "within")

wlnWAGCgrfe <- plm(wlnWAGCgr ~  wlnREVgr + REF2016 + wREF2016lnREVgr + wTAtREV + wWAGETSALE + wDEBTTA +
                    wPPETOTA + wROA + wlnTA + GDPGR, 
                   data = masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016, 2017,2018,2019), ],
                   index = c("RUC", "year"), 
                   model = "within")

# Estimate the random effects regression with plm()
wlnWAGEgrre <- plm(wlnWAGEgr ~  wlnREVgr + REF2016 + wREF2016lnREVgr + wTAtREV + wWAGETSALE + wDEBTTA +
                    wPPETOTA + wROA + wlnTA + GDPGR, 
                   data = masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016,2017,2018,2019), ],
                   index = c("RUC", "year"), 
                   model = "random",
                  random.method = "walhus")

wlnSSCgrre <- plm(wlnSSCgr ~ wTAtREV + wWAGETSALE + wDEBTTA + wPPETOTA + wROA +
                    wlnTA + GDPGR + wlnWAGEgr + REF2016 + wREF2016lnWAGEgr, 
                  data = masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016,2017,2018,2019), ],
                  index = c("RUC", "year"), 
                  model = "random",
                  random.method = "walhus")

wlnWAGCgrre <- plm(wlnWAGCgr ~  wlnREVgr + REF2016 + wREF2016lnREVgr + wTAtREV + wWAGETSALE + wDEBTTA +
                     wPPETOTA + wROA + wlnTA + GDPGR, 
                   data = masterdata[!is.na(masterdata$RUC) & masterdata$year %in% c(2011,2012,2013,2014,2015,2016,2017,2018,2019), ],
                   index = c("RUC", "year"), 
                   model = "random",
                   random.method = "walhus")

#Original coefficients
coeftest(wlnWAGEgrfe)
coeftest(wlnSSCgrfe)
coeftest(wlnWAGCgrfe)

coeftest(wlnWAGEgrre)
coeftest(wlnSSCgrre)
coeftest(wlnWAGCgrre)

summary(wlnWAGEgrfe)
summary(wlnSSCgrfe)
summary(wlnWAGCgrfe)

summary(wlnWAGEgrre)
summary(wlnSSCgrre)
summary(wlnWAGCgrre)

#Plotting variables of interest
library(reshape2)
library(ggplot2)

pre <- masterdata[,c(1,8:31)] 
pre <- masterdata[,c(1,8:31)] %>%
  select(everything())%>%
   group_by(year)%>%
  summarise_each(list(sum))

pre <- melt(pre,id.vars = "year")

ggplot(pre,aes(x=year,y=value,group=variable))+
  geom_area(aes(color=variable,fill=variable),alpha=0.2)+
  theme(legend.position = "bottom")+theme_minimal()

ggplot(data = pre, aes(x = year, y = value)) +
  geom_line(aes(group = '')) +
  facet_wrap(facets = vars(variable))+facet_wrap(variable ~ .,scales="free" )


#Diagnostics
library(tseries)

 #Displaying the fixed effects (constants for each firm)
 fixef(wlnWAGEgrfe)
 summary(fixef(wlnWAGEgrfe))
 
 #Running a hausman test comparing random and fixed effects
 #the null hypothesis is that the preferred model is random effects
 phtest(wlnWAGEgrfe, wlnWAGEgrre)
 phtest(wlnSSCgrfe, wlnSSCgrre)
 phtest(wlnWAGCgrfe, wlnWAGCgrre)
 
 #Testing time-fixed effects
 #The null is that no time-fixed effects needed
 plmtest(wlnWAGEgrfe, c("time"), type=("bp"))
 
 #Testing for cross-sectional dependence
 #The null hypothesis is that residuals across entities are not correlated.
 pcdtest(wlnWAGEgrfe, test = c("lm"))
 pcdtest(wlnWAGEgrfe, test = c("cd"))
 
 #Testing for serial correlation (Autocorrelation)
 #The null hypothesis is that there is not serial correlation.
 pbgtest(wlnWAGEgrfe)
 
 #Testing for unit roots/stationarity
 #The null hypothesis is that the series has a unit root (non-stationary)
 adf.test(masterdata$wlnWAGEgr, k=2)

 #Testing for heteroskedasticity
 #The null hypothesis for the Breusch-Pagan test is homoskedasticity.
 bptest( wlnWAGEgr ~  wlnREVgr + REF2016 + wREF2016lnREVgr + wTAtREV + wWAGETSALE + wDEBTTA +
           wPPETOTA + wROA + wlnTA + GDPGR, 
         data = masterdata, studentize=F)
 
 #Controlling for heteroskedasticity:
 #print summary using robust standard errors
 #heteroskedasticity-robust standard errors
 #Controlling for heteroskedasticity: Robust covariance matrix estimation (Sandwich estimator)
 
 coeftest(wlnWAGEgrfe, vcov. = vcovHC, type = "HC0")
 coeftest(wlnSSCgrfe, vcov. = vcovHC, type = "HC0")
 coeftest(wlnWAGCgrfe, vcov. = vcovHC, type = "HC0")
 
 coeftest(wlnWAGEgrre, vcov. = vcovHC, type = "HC0")
 coeftest(wlnSSCgrre, vcov. = vcovHC, type = "HC0")
 coeftest(wlnWAGCgrre, vcov. = vcovHC, type = "HC0")

 qqnorm(residuals(wlnWAGEgrfe), ylab = 'Residuals')
 qqline(residuals(wlnWAGEgrfe))
 hist(residuals(wlnWAGEgrfe), xlab = 'Residuals')
 plot( residuals(wlnWAGEgrfe))
 
 #Predicted values
 pred <- predict(wlnWAGEgrfe)
 plot(residuals(wlnWAGEgrfe))
 masterdata$wlnWAGEgr - residuals(wlnWAGEgrfe)
 resid(wlnWAGEgrfe)

require(lattice)
xyplot(resid(wlnWAGEgrfe) ~ RUC, data=masterdata)

#Relationship between variables: the effect of independent variable on dependent variable
with(masterdata, plot(wlnREVgr, wlnWAGEgr,
                      main = 'wlnWAGEgr vs. wlnREVgr'))

#Residuals vs. Fitted
par(bg = '#eeeeee')
fitted.values <-as.numeric(masterdata$wlnWAGEgr - residuals(wlnWAGEgrfe))
plot(fitted.values, residuals(wlnWAGEgrfe),
     bty = 'n', xlab = 'Fitted Values', ylab = 'Residuals',
     main = 'Residuals vs. Fitted')
abline(h = 0, col = 'red', lty = 'dashed')

#panel plot
#check variables

 #Summary

 # gather clustered standard errors in a list
 rob_se <- list(sqrt(diag(vcovHC(wlnWAGEgrfe, type = "HC0"))),
                sqrt(diag(vcovHC(wlnWAGEgrre, type = "HC0"))),
               # sqrt(diag(vcovHC(wlnSSCgrfe, type = "HC0"))),
                #sqrt(diag(vcovHC(wlnSSCgrre, type = "HC0"))),
                sqrt(diag(vcovHC(wlnWAGCgrfe, type = "HC0"))),
                sqrt(diag(vcovHC(wlnWAGCgrre, type = "HC0"))))

  # generate the table
 stargazer(wlnWAGEgrfe,wlnWAGEgrre,wlnWAGCgrfe,wlnWAGCgrre, 
           digits = 3,
           header = FALSE,
           type = "text", 
           se = rob_se,out = "Tablas_EQ.txt",
           title = "Linear Panel Regression Models of Labor Cost Reductions Due to Labor Flexibilization",
           model.numbers = FALSE,
           column.labels = c("(fe)","(re)","(fe)","(re)"))

#Graphics
 
#Para hacer gr?ficos, ejecutar c?digo hasta la linea 600 y luego "Graphics"
 library(dygraphs)
 library(dplyr)
 library(DescTools)
 #masterdata <-read.csv(file = 'masterdata1.csv') #original data

 # graph <- masterdata %>%
 # select(year,cargassociales,sueldossalariosyasimila,gastosdepersonal)%>%#,cargassocialesact,sueldossalariosyasimilaact,gastosdepersonalact
 #   group_by(year)%>%
 #  summarise_each(list(sum))%>%
 # mutate(lnSSCgr=log(cargassociales/dplyr::lag (cargassociales,1)),
 #        lnWAGEgr= log(sueldossalariosyasimila / dplyr::lag(sueldossalariosyasimila,1)),
 #        lnWAGCgr= log(gastosdepersonal / dplyr::lag(gastosdepersonal,1)),
 #        wlnSSCgr = DescTools::Winsorize(lnSSCgr,val = quantile(lnSSCgr,probs = c(0.05, 0.95),na.rm = T)),
 #         wlnWAGEgr = DescTools::Winsorize(lnWAGEgr,val = quantile(lnWAGEgr,probs = c(0.05, 0.95),na.rm = T)),
 #        wlnWAGCgr = DescTools::Winsorize(lnWAGCgr,val = quantile(lnWAGCgr,probs = c(0.05, 0.95),na.rm = T))
          #)
  graph <- masterdata %>%
    as.data.frame() %>%
    select(year, cargassociales, sueldossalariosyasimila, gastosdepersonal) %>%
    mutate(year = as.numeric(as.character(year))) %>%
    group_by(year) %>%
    dplyr::summarise(
      dplyr::across(everything(), sum),
      .groups = "drop"
    ) %>%
    arrange(year) %>%
    mutate(
      lnSSCgr = log(cargassociales / dplyr::lag(cargassociales)),  # <- fuerza el lag correcto
      lnWAGEgr = log(sueldossalariosyasimila / dplyr::lag(sueldossalariosyasimila)),
      lnWAGCgr = log(gastosdepersonal / dplyr::lag(gastosdepersonal)),
      wlnSSCgr = Winsorize(lnSSCgr, val = quantile(lnSSCgr, probs = c(0.05, 0.95), na.rm = TRUE)),
      wlnWAGEgr = Winsorize(lnWAGEgr, val = quantile(lnWAGEgr, probs = c(0.05, 0.95), na.rm = TRUE)),
      wlnWAGCgr = Winsorize(lnWAGCgr, val = quantile(lnWAGCgr, probs = c(0.05, 0.95), na.rm = TRUE))
    )

  #WAGE 
 graphwage <- graph%>%
   filter(year != 2019) %>%
   select(lnWAGEgr)  
 
 tsdatos1 <- ts(graphwage,start = c(2011,1),frequency = 1)
 
 dygraph(tsdatos1)

 #veamos las anotaciones y regiones de sombreado
 
 graficodinamico1 <- dygraph(tsdatos1,main="% CRECIMIENTO DE SALARIOS",
                            xlab ="Periodo",
                            ylab = "Crecimiento") %>%
   dyOptions(fillGraph = T,fillAlpha = 0.04,
             drawPoints = T,pointSize = 3,
             pointShape = "star",gridLineColor = "blue")%>%
   dyHighlight(highlightCircleSize = 8,
               highlightSeriesBackgroundAlpha = 1,hideOnMouseOut = F,
               highlightSeriesOpts = list(strokeWidth = 3))%>%
   dyRangeSelector()%>%
   dyAnnotation("2016-03-28",text = "IE",tooltip = "Reforma laboral")%>%
   dyShading(from = "2011-01-01", to = "2016-03-27",color = "#E0FFFF")%>%
   dyShading(from = "2016-04-28", to = "2019-12-31",color = "#e7e1ef")%>%
   dyEvent("2016-03-28","inicio recesivo",labelLoc = "top")
 
 graficodinamico1

 #SSC
 graphssc <- graph%>%
   select(lnSSCgr)  
 
 tsdatos2 <- ts(graphssc,start = c(2011,1),frequency = 1)
 
 dygraph(tsdatos2)
 
 #veamos las anotaciones y regiones de sombreado
 
 graficodinamico2 <- dygraph(tsdatos2,main="% Crecimiento de seguridad social",
                             xlab ="Periodo",
                             ylab = "Crecimiento") %>%
   dyOptions(fillGraph = T,fillAlpha = 0.04,
             drawPoints = T,pointSize = 3,
             pointShape = "star",gridLineColor = "blue")%>%
   dyHighlight(highlightCircleSize = 8,
               highlightSeriesBackgroundAlpha = 1,hideOnMouseOut = F,
               highlightSeriesOpts = list(strokeWidth = 3))%>%
   dyRangeSelector()%>%
   dyAnnotation("2016-03-28",text = "IE",tooltip = "Reforma laboral")%>%
   dyShading(from = "2011-01-01", to = "2016-03-27",color = "#E0FFFF")%>%
   dyShading(from = "2016-04-28", to = "2019-12-31",color = "#e7e1ef")%>%
   dyEvent("2016-03-28","inicio recesivo",labelLoc = "top")
 
 graficodinamico2
 
 #WAGC (total labor costs)
 graphwagc <- graph%>%
   filter(year != 2019) %>%
   select(lnWAGCgr)  
 
 tsdatos3 <- ts(graphwagc,start = c(2011,1),frequency = 1)
 
 dygraph(tsdatos3)
 
 #veamos las anotaciones y regiones de sombreado
 
 graficodinamico3 <- dygraph(tsdatos3,main="% CRECIMIENTO DE COSTE LABORAL TOTAL",
                             xlab ="Periodo",
                             ylab = "Crecimiento") %>%
   dyOptions(fillGraph = T,fillAlpha = 0.04,
             drawPoints = T,pointSize = 3,
             pointShape = "star",gridLineColor = "blue")%>%
   dyHighlight(highlightCircleSize = 8,
               highlightSeriesBackgroundAlpha = 1,hideOnMouseOut = F,
               highlightSeriesOpts = list(strokeWidth = 3))%>%
   dyRangeSelector()%>%
   dyAnnotation("2016-03-28",text = "IE",tooltip = "Reforma laboral")%>%
   dyShading(from = "2011-01-01", to = "2016-03-27",color = "#E0FFFF")%>%
   dyShading(from = "2016-04-28", to = "2019-12-31",color = "#e7e1ef")%>%
   dyEvent("2016-03-28","inicio recesivo",labelLoc = "top")

 graficodinamico3

 #Print graphics
 library(webshot)
 library(htmlwidgets)
 library(dygraphs)
 webshot::install_phantomjs()
 
 saveWidget(graficodinamico1,file ="graf1-labor-market.html", selfcontained = TRUE, libdir = NULL)
 webshot(url = "graf1-labor-market.html",file="graf1-labor-market.png") 
 
 saveWidget(graficodinamico3,file ="graf2-labor-market.html", selfcontained = TRUE, libdir = NULL)
 webshot(url = "graf2-labor-market.html",file="graf2-labor-market.png") 
 